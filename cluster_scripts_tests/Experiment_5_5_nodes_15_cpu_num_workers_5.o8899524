Allocate Nodes = <hpc-c11-node15 hpc-c11-node11 hpc-c10-node01>
set up ray cluster...


Working with node hpc-c11-node15
first allocate node - use as headnode ...
2022-10-04 19:41:40,612	INFO scripts.py:357 -- Using IP address 192.168.115.81 for this node.
2022-10-04 19:41:40,623	INFO resource_spec.py:212 -- Starting Ray with 784.77 GiB memory available for workers and up to 186.26 GiB for objects. You can adjust these settings with ray.init(memory=<bytes>, object_store_memory=<bytes>).
2022-10-04 19:41:41,559	INFO services.py:1170 -- View the Ray dashboard at [1m[32mlocalhost:8265[39m[22m
2022-10-04 19:41:41,597	INFO scripts.py:387 -- 
Started Ray on this node. You can add additional nodes to the cluster by calling

    ray start --address='192.168.115.81:3679' --redis-password='24f99551-ed96-4989-baaf-a42ca42d5d30'

from the node you wish to add. You can connect a driver to the cluster from Python by running

    import ray
    ray.init(address='auto', redis_password='24f99551-ed96-4989-baaf-a42ca42d5d30')

If you have trouble connecting from a different machine, check that your firewall is configured properly. If you wish to terminate the processes that have been started, run

    ray stop

Working with node hpc-c11-node11
then allocate other nodes:  1
node NAME: hpc-c11-node11.unitn.it
node IP: 192.168.115.78
dest IP: 192.168.115.81:3679
2022-10-04 19:41:53,912	INFO scripts.py:429 -- Using IP address 192.168.115.78 for this node.
2022-10-04 19:41:53,928	INFO resource_spec.py:212 -- Starting Ray with 666.41 GiB memory available for workers and up to 186.26 GiB for objects. You can adjust these settings with ray.init(memory=<bytes>, object_store_memory=<bytes>).
2022-10-04 19:41:53,962	INFO scripts.py:438 -- 
Started Ray on this node. If you wish to terminate the processes that have been started, run

    ray stop

Working with node hpc-c10-node01
then allocate other nodes:  2
node NAME: hpc-c11-node11.unitn.it
node IP: 192.168.115.78
dest IP: 192.168.115.81:3679
exiting hpc-c11-node11.unitn.it
2022-10-04 19:42:09,536	INFO scripts.py:429 -- Using IP address 192.168.115.78 for this node.
2022-10-04 19:42:09,546	INFO resource_spec.py:212 -- Starting Ray with 662.89 GiB memory available for workers and up to 186.26 GiB for objects. You can adjust these settings with ray.init(memory=<bytes>, object_store_memory=<bytes>).
2022-10-04 19:42:09,573	INFO scripts.py:438 -- 
Started Ray on this node. If you wish to terminate the processes that have been started, run

    ray stop

done, now launching python program
exiting hpc-c11-node11.unitn.it
Inside covid19_components.py: 0 GPUs are available.
No GPUs found! Running the simulation on a CPU.
Inside covid19_env.py: 0 GPUs are available.
No GPUs found! Running the simulation on a CPU.
2022-10-04 19:43:21,055	WARNING worker.py:809 -- When connecting to an existing cluster, _internal_config must match the cluster's _internal_config.
2022-10-04 19:43:21,089 seed (final): 28857000
2022-10-04 19:43:21,150	INFO trainer.py:421 -- Tip: set 'eager': true or the --eager flag to enable TensorFlow eager execution
2022-10-04 19:43:21,352	INFO trainer.py:580 -- Current log_level is WARN. For more information, set 'log_level': 'INFO' / 'DEBUG' or use the -v and -vv flags.
2022-10-04 19:43:43,861	INFO trainable.py:180 -- _setup took 22.511 seconds. If your trainable is slow to initialize, consider setting reuse_actors=True to reduce actor creation overheads.
2022-10-04 19:43:43,861	INFO trainable.py:217 -- Getting current IP.
2022-10-04 19:43:59,074	INFO trainable.py:180 -- _setup took 15.143 seconds. If your trainable is slow to initialize, consider setting reuse_actors=True to reduce actor creation overheads.
2022-10-04 19:43:59,074	INFO trainable.py:217 -- Getting current IP.
2022-10-04 19:43:59,078 Not restoring trainer...
2022-10-04 19:43:59,078 Starting with fresh agent TF weights.
2022-10-04 19:43:59,078 Starting with fresh planner TF weights.
Training
-- PPO Agents -- Steps done: 0
2022-10-04 19:46:55,906 Iter 1: steps this-iter 4000 total 4000 -> 4/5000 episodes done
2022-10-04 19:46:55,911 custom_metrics: {}
date: 2022-10-04_19-46-55
done: false
episode_len_mean: 1000.0
episode_reward_max: 106.44410053383629
episode_reward_mean: 46.83351349811762
episode_reward_min: 10.572810168184114
episodes_this_iter: 4
episodes_total: 4
experiment_id: 4e7fd03d956547b193fb2a10dc1575a8
hostname: hpc-c11-node15.unitn.it
info:
  grad_time_ms: 129258.385
  learner:
    agent_policy:
      cur_kl_coeff: 0.0
      cur_lr: 0.0003000000142492354
      entropy: 1.6677048206329346
      entropy_coeff: 0.02500000037252903
      kl: 0.09102524816989899
      model: {}
      policy_loss: -0.11456328630447388
      total_loss: -0.14113853871822357
      vf_explained_var: 0.8052080273628235
      vf_loss: 0.30234694480895996
  load_time_ms: 1205.18
  num_steps_sampled: 4000
  num_steps_trained: 16000
  sample_time_ms: 37220.045
  update_time_ms: 7772.627
iterations_since_restore: 1
node_ip: 192.168.115.81
num_healthy_workers: 2
off_policy_estimator: {}
optimizer_steps_this_iter: 1
perf:
  cpu_util_percent: 60.362
  ram_util_percent: 3.208
pid: 3823
policy_reward_max:
  agent_policy: 38.73093174847045
  planner_policy: 23.000000000001382
policy_reward_mean:
  agent_policy: 9.43063586153761
  planner_policy: 9.110970051967444
policy_reward_min:
  agent_policy: -1.2294092402679637
  planner_policy: 1.3333333333354465
sampler_perf:
  mean_env_wait_ms: 2.281745513161083
  mean_inference_ms: 3.5104273796558143
  mean_processing_ms: 0.7125139236450195
time_since_restore: 175.85266137123108
time_this_iter_s: 175.85266137123108
time_total_s: 175.85266137123108
timestamp: 1664905615
timesteps_since_restore: 4000
timesteps_this_iter: 4000
timesteps_total: 4000
training_iteration: 1

2022-10-04 19:46:56,074 >> Wrote dense logs to: /home/ettore.saggiorato/ai-economist-ppo-decision-tree/ai-economist/tutorials/rllib/experiments/check/phase1_gpu/dense_logs/logs_0000000000004000
-- PPO Agents -- Steps done: 4
2022-10-04 19:49:17,696 Iter 2: steps this-iter 4000 total 8000 -> 8/5000 episodes done
2022-10-04 19:49:17,702 custom_metrics: {}
date: 2022-10-04_19-49-17
done: false
episode_len_mean: 1000.0
episode_reward_max: 131.11961836989664
episode_reward_mean: 57.73684875403862
episode_reward_min: 10.572810168184114
episodes_this_iter: 4
episodes_total: 8
experiment_id: 4e7fd03d956547b193fb2a10dc1575a8
hostname: hpc-c11-node15.unitn.it
info:
  grad_time_ms: 128578.918
  learner:
    agent_policy:
      cur_kl_coeff: 0.0
      cur_lr: 0.0003000000142492354
      entropy: 1.726143717765808
      entropy_coeff: 0.02500000037252903
      kl: 0.12498869001865387
      model: {}
      policy_loss: -0.15640738606452942
      total_loss: -0.18333007395267487
      vf_explained_var: 0.9110895991325378
      vf_loss: 0.3246176540851593
  load_time_ms: 1110.386
  num_steps_sampled: 8000
  num_steps_trained: 32000
  sample_time_ms: 24922.659
  update_time_ms: 3890.45
iterations_since_restore: 2
node_ip: 192.168.115.81
num_healthy_workers: 2
off_policy_estimator: {}
optimizer_steps_this_iter: 1
perf:
  cpu_util_percent: 60.355865921787704
  ram_util_percent: 3.2430167597765363
pid: 3823
policy_reward_max:
  agent_policy: 68.94109312169772
  planner_policy: 23.000000000001382
policy_reward_mean:
  agent_policy: 11.879931186913897
  planner_policy: 10.217124006383244
policy_reward_min:
  agent_policy: -2.850941311116471
  planner_policy: 1.3333333333354465
sampler_perf:
  mean_env_wait_ms: 2.2596581214509097
  mean_inference_ms: 3.4151630621020717
  mean_processing_ms: 0.7190470902867926
time_since_restore: 317.45103430747986
time_this_iter_s: 141.59837293624878
time_total_s: 317.45103430747986
timestamp: 1664905757
timesteps_since_restore: 8000
timesteps_this_iter: 4000
timesteps_total: 8000
training_iteration: 2

-- PPO Agents -- Steps done: 8
2022-10-04 19:51:40,471 Iter 3: steps this-iter 4000 total 12000 -> 11/5000 episodes done
2022-10-04 19:51:40,476 custom_metrics: {}
date: 2022-10-04_19-51-40
done: false
episode_len_mean: 1000.0
episode_reward_max: 135.03669709980045
episode_reward_mean: 72.72476316106429
episode_reward_min: 10.572810168184114
episodes_this_iter: 3
episodes_total: 11
experiment_id: 4e7fd03d956547b193fb2a10dc1575a8
hostname: hpc-c11-node15.unitn.it
info:
  grad_time_ms: 128621.814
  learner:
    agent_policy:
      cur_kl_coeff: 0.0
      cur_lr: 0.0003000000142492354
      entropy: 1.7512004375457764
      entropy_coeff: 0.02500000037252903
      kl: 0.13487300276756287
      model: {}
      policy_loss: -0.18118831515312195
      total_loss: -0.20696412026882172
      vf_explained_var: 0.9328577518463135
      vf_loss: 0.36008405685424805
  load_time_ms: 1079.026
  num_steps_sampled: 12000
  num_steps_trained: 48000
  sample_time_ms: 20925.788
  update_time_ms: 2597.257
iterations_since_restore: 3
node_ip: 192.168.115.81
num_healthy_workers: 2
off_policy_estimator: {}
optimizer_steps_this_iter: 1
perf:
  cpu_util_percent: 58.886666666666656
  ram_util_percent: 3.1872222222222217
pid: 3823
policy_reward_max:
  agent_policy: 68.94109312169772
  planner_policy: 41.783543637954075
policy_reward_mean:
  agent_policy: 14.589853449827917
  planner_policy: 14.365349361752816
policy_reward_min:
  agent_policy: -2.850941311116471
  planner_policy: 1.3333333333354465
sampler_perf:
  mean_env_wait_ms: 2.2427352966344483
  mean_inference_ms: 3.3583974805258787
  mean_processing_ms: 0.7194662175230845
time_since_restore: 460.1959505081177
time_this_iter_s: 142.74491620063782
time_total_s: 460.1959505081177
timestamp: 1664905900
timesteps_since_restore: 12000
timesteps_this_iter: 4000
timesteps_total: 12000
training_iteration: 3

-- PPO Agents -- Steps done: 11
=>> PBS: job killed: walltime 602 exceeded limit 600
*** Aborted at 1664905900 (unix time) try "date -d @1664905900" if you are using GNU date ***
PC: @                0x0 (unknown)
*** SIGTERM (@0xd4b) received by PID 3823 (TID 0x2b39f546c3c0) from PID 3403; stack trace: ***
    @     0x2b39f566a630 (unknown)
    @     0x2b39f5666de2 __pthread_cond_timedwait
    @     0x2b39fd5b4011 ray::GetRequest::Wait()
    @     0x2b39fd5b4a97 ray::CoreWorkerMemoryStore::GetImpl()
    @     0x2b39fd5b5d5b ray::CoreWorkerMemoryStore::Wait()
    @     0x2b39fd562cae ray::CoreWorker::Wait()
    @     0x2b39fd4f8831 __pyx_pw_3ray_7_raylet_10CoreWorker_29wait()
    @           0x4634d4 _PyMethodDef_RawFastCallKeywords
    @           0x56dfe5 _PyMethodDescr_FastCallKeywords
    @           0x4fc073 _PyEval_EvalFrameDefault
    @           0x501a88 _PyEval_EvalCodeWithName
    @           0x4625aa _PyFunction_FastCallKeywords
    @           0x4fbdec _PyEval_EvalFrameDefault
    @           0x46217a function_code_fastcall
    @           0x4f77d8 _PyEval_EvalFrameDefault
    @           0x501ed8 _PyEval_EvalCodeWithName
    @           0x4625aa _PyFunction_FastCallKeywords
    @           0x4f79ff _PyEval_EvalFrameDefault
    @           0x501a88 _PyEval_EvalCodeWithName
    @           0x4625aa _PyFunction_FastCallKeywords
    @           0x4f79ff _PyEval_EvalFrameDefault
    @           0x46217a function_code_fastcall
    @           0x4fbdec _PyEval_EvalFrameDefault
    @           0x46217a function_code_fastcall
    @           0x4f79ff _PyEval_EvalFrameDefault
    @           0x50279e PyEval_EvalCode
    @           0x5b082e run_mod
    @           0x439737 PyRun_FileExFlags
    @           0x439af8 PyRun_SimpleFileExFlags
    @           0x58d372 pymain_main
    @           0x58d68c _Py_UnixMain
    @     0x2b39f5fa2555 __libc_start_main
